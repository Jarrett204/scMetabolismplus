DimPlot.metabolism(obj = Singlecell_Al_meta, pathway = "Etherlipidmetabolism/hsa00565", dimention.reduction.type = "umap", dimention.reduction.run = F, size = 1)
Singlecell_Al <- Singlecell_Al[,1:500]
Singlecell_Al <- readRDS('../AB.rds')
Singlecell_Al <- Singlecell_Al[,1:5000]
Singlecell_Al_meta <- scMetabolismplus::sc.metabolism.Seurat(Singlecell_Al,method =="AUCell",Cancer="LAML")
DimPlot.metabolism(obj = Singlecell_Al_meta, pathway = "Etherlipidmetabolism/hsa00565", dimention.reduction.type = "umap", dimention.reduction.run = F, size = 1)
DimPlot.metabolism(obj = Singlecell_Al_meta, pathway = "Etherlipidmetabolism/hsa00565", dimention.reduction.type = "umap", dimention.reduction.run = F, size = 1)
Singlecell_Al <- readRDS('../AB.rds')
Singlecell_Al <- Singlecell_Al[,1:10000]
Singlecell_Al_meta <- scMetabolismplus::sc.metabolism.Seurat(Singlecell_Al,method =="AUCell",Cancer="LAML")
DimPlot.metabolism(obj = Singlecell_Al_meta, pathway = "Etherlipidmetabolism/hsa00565", dimention.reduction.type = "umap", dimention.reduction.run = F, size = 1)
Singlecell_Al <- Singlecell_Al[,1:40000]
Singlecell_Al <- readRDS('../AB.rds')
Singlecell_Al <- Singlecell_Al[,1:40000]
Singlecell_Al_meta <- scMetabolismplus::sc.metabolism.Seurat(Singlecell_Al,method =="AUCell",Cancer="LAML")
DimPlot.metabolism(obj = Singlecell_Al_meta, pathway = "Etherlipidmetabolism/hsa00565", dimention.reduction.type = "umap", dimention.reduction.run = F, size = 1)
Singlecell_BRCA <- readRDS('../AB.rds')
Singlecell_BRCA <- Singlecell_Al[,1:5000]
Singlecell_BRCA_meta <- scMetabolismplus::sc.metabolism.Seurat(Singlecell_BRCA,method =="AUCell",Cancer="LAML")
Singlecell_BRCA_meta <- scMetabolismplus::sc.metabolism.Seurat(Singlecell_BRCA,method =="AUCell",Cancer="BRCA")
DimPlot.metabolism(obj = Singlecell_BRCA_meta, pathway = "Oxidativephosphorylation/hsa00190", dimention.reduction.type = "umap", dimention.reduction.run = F, size = 1)
Singlecell_BRCA <- readRDS('../AB.rds')
Singlecell_BRCA <- Singlecell_BRCA[,1:5000]
Singlecell_BRCA_meta <- scMetabolismplus::sc.metabolism.Seurat(Singlecell_BRCA,method =="AUCell",Cancer="BRCA")
DimPlot.metabolism(obj = Singlecell_BRCA_meta, pathway = "Oxidativephosphorylation/hsa00190", dimention.reduction.type = "umap", dimention.reduction.run = F, size = 1)
Singlecell_BRCA <- readRDS('../BRCA.rds')
Singlecell_BRCA <- Singlecell_BRCA[,1:5000]
Singlecell_BRCA_meta <- scMetabolismplus::sc.metabolism.Seurat(Singlecell_BRCA,method =="AUCell",Cancer="BRCA")
DimPlot.metabolism(obj = Singlecell_BRCA_meta, pathway = "Oxidativephosphorylation/hsa00190", dimention.reduction.type = "umap", dimention.reduction.run = F, size = 1)
Singlecell_BLCA <- readRDS('../BLCA.rds')
Singlecell_BLCA <- Singlecell_BLCA[,1:5000]
Singlecell_BLCA_meta <- scMetabolismplus::sc.metabolism.Seurat(Singlecell_BLCA,method =="AUCell",Cancer="BRCA")
DimPlot.metabolism(obj = Singlecell_BLCA_meta, pathway = "Oxidativephosphorylation/hsa00190", dimention.reduction.type = "umap", dimention.reduction.run = F, size = 1)
Singlecell_BLCA <- readRDS('../BLCA.rds')
Singlecell_BLCA <- Singlecell_BLCA[,1:3000]
Singlecell_BLCA_meta <- scMetabolismplus::sc.metabolism.Seurat(Singlecell_BLCA,method =="AUCell",Cancer="BRCA")
DimPlot.metabolism(obj = Singlecell_BLCA_meta, pathway = "Oxidativephosphorylation/hsa00190", dimention.reduction.type = "umap", dimention.reduction.run = F, size = 1)
View(Singlecell_BRCA)
Singlecell_BRCA@images
DimPlot("Singlecell_BRCA",reduction="tsne")
library(Seurat)
DimPlot("Singlecell_BRCA",reduction="tsne")
DimPlot(Singlecell_BRCA,reduction="tsne")
DimPlot(Singlecell_BRCA,reduction="umpa")
DimPlot("Singlecell_BRCA",reduction="umap")
DimPlot(Singlecell_BRCA,reduction="umap")
library(tidyverse)
# Load the data
data <- read.csv("./data/HMDB和除去DriverDB.csv") # Make sure to replace the path with your actual data file location
library(dplyr)
# Normalize column names for easier handling
data <- data %>%rename(
driver_gene = Gene, # Replace 'driver_gene' with the actual column name in your file if different
Pathway = Pathway, # Same here, replace 'Pathway' with your column name
Cancer_type = Cancer_type # And replace 'Cancer_type' with your column name
)
# Define the output directory where the GMT files will be saved
output_dir <- "./data/HMDB/" # Change this to your desired output directory
# Process the data for each cancer type
library(dplyr)
df <- data
# Assuming df is your data frame
# Group by Cancer_type and Pathway, then summarise
df_grouped <- df %>%
group_by(Cancer_type, Pathway) %>%
summarise(genes = paste(unique(driver_gene), collapse = "\t"), .groups = "drop")
# Split the data frame by Cancer_type
df_split <- split(df_grouped, df_grouped$Cancer_type)
# Use lapply to iterate over the list and create a GMT file for each cancer type
lapply(names(df_split), function(cancer_type) {
filepath <- paste0(output_dir,cancer_type, ".gmt")
write.table(df_split[[cancer_type]][, c("Pathway", "genes")],
file = filepath,
row.names = FALSE,
col.names = FALSE,
quote = FALSE,
sep = "\t")
})
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell, method = "AUCell",metabolism.type = "Reactome",Cancer = "KIRC")
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell, method = "AUCell",metabolism.type = "Reactome",Cancer = "KIRC")
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
library(scMetabolismplus)
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "Reactome",Cancer = "KIRC")
Cancer='BRCA'
signatures_GO_metab <- system.file("data/GO/", paste0(Cancer,".gmt"), package = "scMetabolismplus")
signatures_GO_metab
metabolism.type="GO"
if (metabolism.type == "GO")  {gmtFile<-signatures_GO_metab; cat("Your choice is: GO\n")}
gmtFile
getGmt(gmtFile) #
library(rsvd)
devtools::build("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "Reactome",Cancer = "KIRC")
devtools::install("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "Reactome",Cancer = "BRCA")
devtools::build("D:/NAR/scMetabolismplus/")
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell_Al[,1:1000]
Singlecell2 <- Singlecell[,1:1000]
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "Reactome",Cancer = "BRCA")
signatures_HALLMARK_metab <- system.file("extdata/Hallmark/", paste0("BRCA",".gmt"), package = "scMetabolismplus")
gmtFile<-signatures_HALLMARK_metab; cat("Your choice is: Hallmark\n")
gmtFile
get(gmt)
get(gmtFile)
get("D:/Softwares/R-4.3.2/library/scMetabolismplus/extdata/Hallmark/BRCA.gmt")
getGmt(gmtFile)
gmtFile
?getGmt
library(GSEABase)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "Reactome",Cancer = "BRCA")
system.file("extdata/HMDB", paste0("BRCA",".gmt"), package = "scMetabolismplus")
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "Reactome",Cancer = "BRCA")
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplo2)
library(ggplot2)
devtools::build("D:/NAR/scMetabolismplus/")
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
input_pathway=read.csv('./data/Hallmark_ALL.csv')$Pathway%>%unique()
library(tibble)
input_pathway=read.csv('./data/Hallmark_ALL.csv')$Pathway%>%unique()
input_pathway
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot_env
View(tt)
tt$result
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
devtools::build("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$data
tt$result
devtools::build("D:/NAR/scMetabolismplus/")
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt@result
tt$result
devtools::build("D:/NAR/scMetabolismplus/")
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
View(tt)
devtools::build("D:/NAR/scMetabolismplus/")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
devtools::build("D:/NAR/scMetabolismplus/")
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
library(scMetabolismplus)
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
devtools::build("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
library(tibble)
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
library(ggplot2)
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$data
gg_table_median_norm
devtools::build("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
input_pathway=read.csv('./data/reactome和除去DriverDB(1).csv')$Pathway%>%unique()
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
tt
tt$data
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
?rgba
??rgba
devtools::build("D:/NAR/scMetabolismplus/")
devtools::install("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
library(tibble)
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
# 定义基础颜色
base_colors <- c("#4D457E", "#CD506B", "#E9DF45")
# 定义基础颜色
base_colors <- c("#4D457E", "#CD506B", "#E9DF45")
# 创建渐变色调色板函数
pal <- colorRampPalette(base_colors)(100)
pal
library(ggsci)
?ggsci
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
pal
devtools::build("D:/NAR/scMetabolismplus/")
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
Singlecell2 <- Singlecell
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
Singlecell2 <- Singlecell
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
signature_ggplot
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
dev.off()
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
DimPlot.metabolism(kk,pathway="Steroidhormonebiosynthesis/hsa00140",dimention.reduction.run = F)
