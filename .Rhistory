tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
DimPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters",dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
debugSource("D:/NAR/scMetabolismplus测试.R", echo=TRUE)
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
rlang::last_trace()
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
signature_ggplot
rlang::last_trace()
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
signature_exp<-Singlecell2@assays$METABOLISM$score
signature_exp
signature_exp<-tt@assays$METABOLISM$score
signature_exp<-kk@assays$METABOLISM$score
signature_exp
signature_exp["Etherlipidmetabolism/hsa00565", ,drop=T]
signature_exp["Etherlipidmetabolism/hsa00565", ,drop=F]
JJ <- signature_exp["Etherlipidmetabolism/hsa00565", ,drop=F]
JJ
class(jj)
class(JJ)
as.vector(JJ)
JJ <- signature_exp["Etherlipidmetabolism/hsa00565", ,drop=T]
JK
JJ
JJ[c(1:4)]
# 假设JJ是你的列表
# 转换JJ为一个向量
JJ_vector <- unlist(JJ)
# 打印结果查看
print(JJ_vector)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
zz <- DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
zz
zz$facet
pdf("./facet.pdf")
zz
dev.off()
devtools::build("D:/NAR/scMetabolismplus/")
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
input_pathway
input_pathway[1]
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
signature_exp
signature_exp
Score = unlist(signature_exp["Etherlipidmetabolism/hsa00565", ,drop=T])
Score
length(Score)
umap.loc
umap.loc<-kk@reductions$umap@cell.embeddings
umap.loc
class(umap.loc)
signature_ggplot <- data.frame(umap.loc, Pathway = input.pathway, Score = unlist(signature_exp[input.pathway, ,drop=T]))
Score
signature_exp
signature_ggplot <- data.frame(umap.loc, Pathway = "Etherlipidmetabolism/hsa00565 ", Score = unlist(signature_exp[input.pathway, ,drop=T]))
signature_ggplot <- data.frame(umap.loc, Pathway = "Etherlipidmetabolism/hsa00565 ", Score = unlist(signature_exp["Etherlipidmetabolism/hsa00565 ", ,drop=T]))
signature_ggplot
Score
names(Score) <- NULL
Score
signature_ggplot <- data.frame(umap.loc, Pathway = "Etherlipidmetabolism/hsa00565 ", Score = unlist(signature_exp["Etherlipidmetabolism/hsa00565 ", ,drop=T]))
signature_ggplot
Score
unlist(signature_exp[input.pathway, ,drop=T])
signature_ggplot <- data.frame(umap.loc, Pathway = "Etherlipidmetabolism/hsa00565 ", Score = unlist(signature_exp["Etherlipidmetabolism/hsa00565 ", ,drop=T]))
signature_ggplot
Score = unlist(signature_exp["Etherlipidmetabolism/hsa00565 ", ,drop=T])
Score
signature_exp
signature_exp["Etherlipidmetabolism/hsa00565", ,drop=T])
signature_exp["Etherlipidmetabolism/hsa00565",])
signature_exp["Etherlipidmetabolism/hsa00565", ,drop=T]
signature_exp["Etherlipidmetabolism/hsa00565", ,drop=T]
input_pathway="Etherlipidmetabolism/hsa00565"
Score = unlist(signature_exp[input.pathway, ,drop=T])
input.pathway="Etherlipidmetabolism/hsa00565"
Score = unlist(signature_exp[input.pathway, ,drop=T])
Score
signature_ggplot <- data.frame(umap.loc, Pathway = input.pathway, Score = unlist(signature_exp[input.pathway, ,drop=T]))
signature_ggplot
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
tt$plot
tt$plot
DimPlot.metabolism(kk,pathway=tt$pathway,dimention.reduction.run = F)
#phenotype是用什么metadata比如注释后的结果
BoxPlot.metabolism(obj = kk, pathway = "Steroidhormonebiosynthesis/hsa00140", phenotype = "seurat_clusters", ncol = 4)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$plot
DimPlot.metabolism(kk,pathway=tt$pathway,dimention.reduction.run = F)
DimPlot.metabolism(kk,pathway=tt$pathway,dimention.reduction.run = F)
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$pathway
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
tt$plot
#phenotype是用什么metadata比如注释后的结果
BoxPlot.metabolism(obj = kk, pathway = tt$pathway, phenotype = "seurat_clusters", ncol = 4)
# 假设pal是你的色板向量
pal <- viridis::viridis(100)
# 创建一个颜色矩阵
color_matrix <- matrix(seq_along(pal), nrow = 1)
# 使用image函数显示色板
image(1:nrow(color_matrix), 1:ncol(color_matrix), t(color_matrix), col = pal, axes = FALSE, ylab = "", xlab = "")
# 假设pal是你的色板向量
pal <- viridis::viridis(100)
# 创建一个颜色矩阵
color_matrix <- matrix(seq_along(pal), nrow = 1)
# 使用image函数显示色板
image(1:nrow(color_matrix), 1:ncol(color_matrix), t(color_matrix), col = pal, axes = FALSE, ylab = "", xlab = "")
library(ggplot2)
# 假设pal是你的色板向量
pal <- viridis::viridis(100)
# 创建一个包含颜色索引的数据框
df_pal <- data.frame(color_index = 1:length(pal))
# 绘制颜色条
ggplot(df_pal, aes(x = color_index, y = 1, fill = factor(color_index))) +
geom_tile() +
scale_fill_manual(values = pal) +
theme_void() +
theme(legend.position = "none") +
labs(x = "", y = "")
library(ggplot2)
# 假设pal是你的色板向量
pal <- viridis::viridis(100)
# 创建一个包含颜色索引的数据框
df_pal <- data.frame(color_index = 1:length(pal))
# 绘制颜色条
ggplot(df_pal, aes(x = color_index, y = 1, fill = factor(color_index))) +
geom_tile() +
scale_fill_manual(values = pal) +
theme_void() +
theme(legend.position = "none") +
labs(x = "", y = "")
pal <- wes_palette("Zissou1", 100, type = "continuous")
pal
library(RColorBrewer)
# 手动组合多个色板
colors <- c(brewer.pal(9, "Set1"), brewer.pal(9, "Set2"), brewer.pal(9, "Set3"))
# 如果需要更多颜色，可以继续添加其他色板或重复现有色板
library(ggplot2)
library(viridis)
# 生成较多的颜色，这里以100种为例
colors <- viridis(100, option = "D")
# 创建一个数据框，包含颜色索引
df_colors <- data.frame(color_index = 1:length(colors), colors = colors)
# 使用ggplot2绘制每种颜色为一个方块
ggplot(df_colors, aes(x = factor(1), y = factor(color_index), fill = colors)) +
geom_tile(color = "white", size = 0.5) +  # 添加白色边框以更清楚地区分颜色块
scale_fill_identity() +  # 使用数据框中的颜色值
theme_void() +  # 移除多余的图表元素
theme(legend.position = "none") +  # 移除图例
labs(x = "", y = "") +  # 移除轴标签
coord_fixed()  # 保持方块的宽高比为1
library(RColorBrewer)
# 手动组合多个色板
colors <- c(brewer.pal(9, "Set1"), brewer.pal(9, "Set2"), brewer.pal(9, "Set3"))
# 如果需要更多颜色，可以继续添加其他色板或重复现有色板
colors
ggplot(colors, aes(x = factor(1), y = factor(color_index), fill = colors)) +
geom_tile(color = "white", size = 0.5) +  # 添加白色边框以更清楚地区分颜色块
scale_fill_identity() +  # 使用数据框中的颜色值
theme_void() +  # 移除多余的图表元素
theme(legend.position = "none") +  # 移除图例
labs(x = "", y = "") +  # 移除轴标签
coord_fixed()  #
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
library("Matrix")
library(Seurat)
library(rsvd)
library(ggplot2)
library(tibble)
Singlecell <- readRDS('../AB.rds')
Singlecell2 <- Singlecell[,1:1000]
input_pathway=read.csv('./data/KEGG_ALL.csv')$Pathway%>%unique()
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#单细胞代谢绘制
tt <- DotPlot.metabolism(kk,pathway=input_pathway,phenotype = "seurat_clusters", norm = "y")
tt$pathway
DimPlot.metabolism(kk,pathway=input_pathway,dimention.reduction.run = F)
#phenotype是用什么metadata比如注释后的结果
BoxPlot.metabolism(obj = kk, pathway = tt$pathway, phenotype = "seurat_clusters", ncol = 4)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#phenotype是用什么metadata比如注释后的结果
BoxPlot.metabolism(obj = kk, pathway = tt$pathway, phenotype = "seurat_clusters", ncol = 4)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#  devtools::install_github("Jarrett204/scMetabolismplus",force = TRUE)
library(scMetabolismplus)
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#phenotype是用什么metadata比如注释后的结果
BoxPlot.metabolism(obj = kk, pathway = tt$pathway, phenotype = "seurat_clusters", ncol = 4)
devtools::build("D:/NAR/scMetabolismplus/")
devtools::check("D:/NAR/scMetabolismplus/")
#单细胞加载
kk <- scMetabolismplus::sc.metabolism.Seurat(Singlecell2, method = "AUCell",metabolism.type = "KEGG",Cancer = "KIRC")
#phenotype是用什么metadata比如注释后的结果
BoxPlot.metabolism(obj = kk, pathway = tt$pathway, phenotype = "seurat_clusters", ncol = 4)
